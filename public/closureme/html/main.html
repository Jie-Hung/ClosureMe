<!-- main.html -->
<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ClosureMe</title>
  <link rel="stylesheet" href="../css/characters.css">
  <link rel="stylesheet" href="../css/toast.css">
  <link rel="stylesheet" href="../css/guide.css">
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/waiting.css" />
</head>

<body>
  <header class="top-bar">
    <div class="logo">
      <img src="../../assets/icons/logo.png" class="logo-img">
      <img src="../../assets/icons/help.png" id="helpBtn" class="help-icon">
      <button id="logoutBtn" class="logout-btn">ç™»å‡º</button>
    </div>
  </header>

  <main class="main-container">
    <!-- é¡¯ç¤ºå€ï¼ˆç¿»è½‰å¡ç‰‡ï¼‰ -->
    <section class="display-area"></section>

    <!-- äººç‰©èˆ‡å ´æ™¯é¸æ“‡å€ -->
    <section class="select-area">
      <div class="select-group">
        <div class="select-header">äººç‰©é¸æ“‡ <span id="char-count">0/3</span></div>
        <div class="select-scroll" id="char-scroll"></div>
      </div>

      <div class="select-group">
        <div class="select-header">å ´æ™¯é¸æ“‡ <span id="scene-count">0/3</span></div>
        <div class="select-scroll" id="scene-scroll"></div>
      </div>

      <button id="imageBtn" class="image-btn">ğŸ› ï¸ åˆå§‹æ¨¡å‹</button>
      <button id="generateBtn" class="generate-btn">â–¶ é–‹å§‹ç”Ÿæˆ</button>
      <button id="filesBtn" class="files-btn" onclick="location.href='files.html'">ğŸ“ æª”æ¡ˆç®¡ç†</button>

    </section>
  </main>

  <!-- guide modal -->
  <div id="guideModal" class="modal">
    <div class="modal-content" id="guideContent"></div>
  </div>

  <!-- Upload Modal -->
  <div id="uploadModal" class="upload-modal">
    <div class="upload-content">
      <h2 id="upload-title">åœ–ç‰‡ä¸Šå‚³ 1/3</h2>

      <div class="upload-main">
        <div id="upload-step-content">
          <!-- é€™è£¡å‹•æ…‹æ’å…¥å…§å®¹ï¼ˆDropzone / Textarea / æª”æ¡ˆæ¸…å–®ï¼‰ -->
        </div>
      </div>

      <div class="upload-controls">
        <button id="upload-prev">â—€</button>
        <button id="upload-next">â–¶</button>
      </div>
    </div>
  </div>

  <!-- åœ–ç‰‡é è¦½ Modal -->
  <div id="previewModal" class="modal">
    <div class="modal-content preview-modal-content">
      <img id="previewImg" src="" alt="é è¦½åœ–ç‰‡" />
    </div>
  </div>

  <!-- æª”æ¡ˆå‘½åè¦–çª— -->
  <div class="filename-modal" id="filenameModal" style="display: none;">
    <div class="filename-content">
      <h3>è«‹è¼¸å…¥æª”æ¡ˆåç¨±</h3>
      <input type="text" class="filename-input" id="filenameInput" placeholder="æœªå‘½å" />
      <div class="filename-buttons">
        <button class="filename-cancel" id="filenameCancel">å–æ¶ˆ</button>
        <button class="filename-confirm" id="filenameConfirm">ç¢ºèª</button>
      </div>
    </div>
  </div>

  <!--å®Œæ•´è¨˜æ†¶è¦–çª—-->
  <div id="descModal" class="desc-modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <pre id="descFullText"></pre>
    </div>
  </div>

  <!-- âœ… åˆ†å‰²åœ–ç‰‡ Modal -->
  <div id="splitModal" class="modal" style="display: none;">
    <div class="modal-box">
      <!-- ä¸»åœ–ç‰‡èˆ‡ç´…ç·š -->
      <div class="split-image-area">
        <canvas id="splitCanvas"></canvas>
        <div id="splitCutLine" class="split-line"></div>
        <div id="splitPercent" class="split-percent">50%</div>
      </div>

      <!-- é è¦½ -->
      <div class="split-preview-container">
        <div>
          <strong>ä¸ŠåŠéƒ¨ï¼ˆHeadï¼‰</strong>
          <img id="headPreview" class="preview-img" />
        </div>
        <div>
          <strong>ä¸‹åŠéƒ¨ï¼ˆBodyï¼‰</strong>
          <img id="bodyPreview" class="preview-img" />
        </div>
      </div>

      <!-- å·¥å…·åˆ— -->
      <div class="split-toolbar">
        <span>800 Ã— 450</span>
        <div class="button-group">
          <button id="btnHalf">åˆ‡ä¸€åŠ</button>
          <button id="btnOneThird">åˆ‡ 1/3</button>
          <button id="btnTwoThird">åˆ‡ 2/3</button>
          <button id="confirmSplitBtn" class="confirm">ç¢ºå®šä¸Šå‚³</button>
          <button id="cancelSplitBtn" class="cancel">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const helpBtn = document.getElementById("helpBtn");
    const guideModal = document.getElementById("guideModal");
    const guideContent = document.getElementById("guideContent");

    helpBtn.addEventListener("click", () => {
      fetch("guide.html")
        .then(res => res.text())
        .then(html => {
          guideContent.innerHTML = html;
          guideModal.style.display = "flex";

          const guideScript = document.createElement("script");
          guideScript.src = "../js/guide.js";
          guideScript.onload = () => {
            initGuideModal();
          };
          document.body.appendChild(guideScript);

          guideModal.addEventListener("click", (e) => {
            if (e.target === guideModal) {
              guideModal.style.display = "none";
            }
          });
        });
    });
  </script>
  <div id="toast" class="toast"></div>
  <script src="/utils/toast.js"></script>
  <script type="module" src="../js/main.js"></script>
  <script type="module" src="../js/waiting.js"></script>

</body>

</html>